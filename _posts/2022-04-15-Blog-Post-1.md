---
layout: post
title: Querying and Visualizing Data
---

# ยง1. Create a Database

We begin by importing the relevant packages, including sqlite3 for sql, pandas to manipulate our data, and plotly to create graphs.

```python
import sqlite3
import pandas as pd
import plotly
```

Next, we will create our database, 'climate.db', and a cursor so that we can query our database.

```python
connection = sqlite3.connect('climate.db') # Create database
cursor = connection.cursor() # Create cursor
```

Now, we will populate our database.  We will do this by reading each file, making sure that the common columns are in the same format, and then enter them into 'climate.db'.

```python
dft = pd.read_csv("temperatures.csv") # Read temperatures file into dft
dft['ID2'] = dft["ID"].astype(str).str[:2] # Get the first two letters as country ID
dft.to_sql("temperatures", connection, if_exists = "replace", index = False) # Enter dft into climate

dfc = pd.read_csv("countries.csv") # Read countries file into dfc
dfc.to_sql("countries", connection, if_exists = "replace", index = False) # Enter dfc into climate

dfs = pd.read_csv("stations.csv") # Read stations file into dfs
dfs.to_sql("stations", connection, if_exists = "replace", index = False) # Enter dfs into climate
```

We have created our database!  All we need to do now is close our connection to the database.

```python
cursor.close()
```

# ยง2. Write a Query Function