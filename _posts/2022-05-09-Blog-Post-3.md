---
layout: post
title: Image Classification
---

## ยง1. Load Packages and Obtain Data

We start by importing modules:

```python
import os
import tensorflow as tf
from tensorflow.keras import utils, datasets, layers, losses
```

Next, we will obtain our data from a zip file:

```python
# location of data
_URL = 'https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip'

# download the data and extract it
path_to_zip = utils.get_file('cats_and_dogs.zip', origin=_URL, extract=True)

# construct paths
PATH = os.path.join(os.path.dirname(path_to_zip), 'cats_and_dogs_filtered')

train_dir = os.path.join(PATH, 'train')
validation_dir = os.path.join(PATH, 'validation')

# parameters for datasets
BATCH_SIZE = 32
IMG_SIZE = (160, 160)

# construct train and validation datasets 
train_dataset = utils.image_dataset_from_directory(train_dir,
                                                   shuffle=True,
                                                   batch_size=BATCH_SIZE,
                                                   image_size=IMG_SIZE)

validation_dataset = utils.image_dataset_from_directory(validation_dir,
                                                        shuffle=True,
                                                        batch_size=BATCH_SIZE,
                                                        image_size=IMG_SIZE)

# construct the test dataset by taking every 5th observation out of the validation dataset
val_batches = tf.data.experimental.cardinality(validation_dataset)
test_dataset = validation_dataset.take(val_batches // 5)
validation_dataset = validation_dataset.skip(val_batches // 5)
```

And now we will fine tune the dataset.

```python
AUTOTUNE = tf.data.AUTOTUNE

train_dataset = train_dataset.prefetch(buffer_size=AUTOTUNE)
validation_dataset = validation_dataset.prefetch(buffer_size=AUTOTUNE)
test_dataset = test_dataset.prefetch(buffer_size=AUTOTUNE)
```

Now that we have the data, we can start by creating a visualization, such as the one below, which outputs one row of three cats, and one row of three dogs.

```python
import matplotlib.pyplot as plt
import numpy as np

def tworowvis():
  plt.figure(figsize=(10, 10))
  for images, labels in train_dataset.take(1):
    i = 0 # Set iterators to 0
    j = 0
    k = 0
    while i < 3: # Plot first row
      ax = plt.subplot(2, 3, i + 1)
      if int(labels[j]) == 0: # Only plot cats
        plt.imshow(images[j].numpy().astype("uint8"))
        plt.title("Cat")
        plt.axis("off")
        i += 1
      j += 1
    while i < 6: # Plot second row
      ax = plt.subplot(2, 3, i + 1)
      if int(labels[k]) == 1: # Only plot dogs
        plt.imshow(images[k].numpy().astype("uint8"))
        plt.title("Dog")
        plt.axis("off")
        i += 1
      k += 1

tworowvis() # Render visualization
```

![Blog-3-Sec-1-Vis.png]({{ site.baseurl }}/images/Blog-3-Sec-1-Vis.png)